<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SmartLearn - Settings</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="../styles.css" />
    <style>
      .settings-page { padding: 3rem 5%; max-width: 1100px; margin: 0 auto; }
      .tabs { display: flex; gap: 0.6rem; flex-wrap: wrap; margin-bottom: 1rem; }
      .tab-btn { padding: 0.6rem 1rem; border: 2px solid var(--primary); color: var(--primary); background: white; border-radius: 8px; font-weight: 600; cursor: pointer; }
      .tab-btn.active { background: var(--primary); color: white; }
      .tab-content { display: none; }
      .tab-content.active { display: block; }
      .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
      .avatar-upload { display: flex; align-items: center; gap: 1rem; }
      .avatar-preview { width: 80px; height: 80px; border-radius: 50%; background: var(--light-gray); display: flex; align-items: center; justify-content: center; overflow: hidden; }
      .avatar-preview img { width: 100%; height: 100%; object-fit: cover; }
      .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
      .form-group { margin-bottom: 1rem; }
      .form-group label { display: block; font-weight: 600; margin-bottom: 0.4rem; }
      .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 0.8rem; border: 2px solid var(--light-gray); border-radius: 8px; }
      .toggle { display: inline-flex; align-items: center; gap: 0.6rem; }
      .logout { display: flex; justify-content: flex-end; margin-top: 1rem; }
      .logout .btn { background: var(--danger); color: white; }
      @media (max-width:768px){ .form-row{ grid-template-columns: 1fr; } }
    </style>
  </head>
  <body>
    <!-- Navigation -->
    <nav>
      <a href="../home.html" class="logo">
        <i class="fas fa-brain"></i>
        <span>SmartLearnðŸ“˜</span>
      </a>
      <div class="nav-icons">
        <div class="role-indicator">
          <i class="fas fa-user-graduate"></i>
          <span>Student</span>
        </div>
        <button class="theme-toggle" id="themeToggle">
          <i class="fas fa-moon"></i>
        </button>
      </div>
    </nav>

    <!-- Student Dashboard -->
    <div class="dashboard">
      <div class="sidebar">
        <div class="sidebar-header">
          <h3>Student Dashboard</h3>
        </div>
        <ul class="sidebar-menu">
          <li>
            <a href="student.html" id="dashboard-link"
              ><i class="fas fa-home"></i> Dashboard</a
            >
          </li>
          <li>
            <a href="courses.html" id="courses"
              ><i class="fas fa-book"></i> My Courses</a
            >
          </li>
          <li>
            <a href="progress.html" id="progress"
              ><i class="fas fa-chart-line"></i> Progress</a
            >
          </li>
          <li>
            <a href="messages.html" id="messages"
              ><i class="fas fa-comments"></i> Messages</a
            >
          </li>
          <li>
            <a href="settings.html" id="settings-link" class="active"
              ><i class="fas fa-cog"></i> Settings</a
            >
          </li>
          <li>
            <button id="chatbotToggle" class="sidebar-btn"
              ><i class="fas fa-robot"></i> Ask AI Tutor</button
            >
          </li>
        </ul>
      </div>
      <div class="main-content">
        <section class="settings-page">
      <h2 class="section-title">Settings</h2>

      <div class="tabs">
        <button class="tab-btn active" data-tab="profile">Profile</button>
        <button class="tab-btn" data-tab="security">Security</button>
        <button class="tab-btn" data-tab="notifications">Notifications</button>
        <button class="tab-btn" data-tab="preferences">Preferences</button>
      </div>

      <div id="profile" class="tab-content active">
        <div class="card-grid">
          <div class="card">
            <div class="card-header"><div class="card-title">Profile Settings</div><div class="card-icon"><i class="fas fa-id-card"></i></div></div>
            <div class="form-group avatar-upload">
              <div class="avatar-preview" id="avatarPreview"><i class="fas fa-user"></i></div>
              <div>
                <input type="file" id="avatarInput" accept="image/*" />
                <div style="color:var(--gray);font-size:0.9rem">Upload a square image for best results</div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group"><label for="name">Name</label><input type="text" id="name" value="Paul Mulilo" /></div>
              <div class="form-group"><label for="email">Email</label><input type="email" id="email" value="SmartLearn@gmail.com" /></div>
            </div>
            <div class="form-group"><label for="bio">Bio</label><textarea id="bio" rows="4" placeholder="Tell us about yourself"></textarea></div>
            <button class="btn">Save Profile</button>
          </div>
        </div>
      </div>

      <div id="security" class="tab-content">
        <div class="card-grid">
          <div class="card">
            <div class="card-header"><div class="card-title">Account Security</div><div class="card-icon"><i class="fas fa-shield-alt"></i></div></div>
            <div class="form-row">
              <div class="form-group"><label for="currentPassword">Current Password</label><input type="password" id="currentPassword" /></div>
              <div class="form-group"><label for="newPassword">New Password</label><input type="password" id="newPassword" /></div>
            </div>
            <div class="form-group"><label for="confirmPassword">Confirm New Password</label><input type="password" id="confirmPassword" /></div>
            <div class="form-group toggle"><input type="checkbox" id="twoFA" /><label for="twoFA">Enable Twoâ€‘Factor Authentication</label></div>
            <button class="btn">Update Security</button>
          </div>
        </div>
      </div>

      <div id="notifications" class="tab-content">
        <div class="card-grid">
          <div class="card">
            <div class="card-header"><div class="card-title">Notification Settings</div><div class="card-icon"><i class="fas fa-bell"></i></div></div>
            <div class="form-group toggle"><input type="checkbox" id="emailNotifs" checked /><label for="emailNotifs">Email Notifications</label></div>
            <div class="form-group toggle"><input type="checkbox" id="pushNotifs" /><label for="pushNotifs">Push Notifications</label></div>
            <button class="btn">Save Notifications</button>
          </div>
        </div>
      </div>

      <div id="preferences" class="tab-content">
        <div class="card-grid">
          <div class="card">
            <div class="card-header"><div class="card-title">Application Preferences</div><div class="card-icon"><i class="fas fa-sliders-h"></i></div></div>
            <div class="form-group toggle"><input type="checkbox" id="prefDark" /><label for="prefDark">Enable Dark Mode</label></div>
            <div class="form-group"><label for="language">Language</label>
              <select id="language">
                <option value="en" selected>English</option>
                <option value="fr">FranÃ§ais</option>
                <option value="es">EspaÃ±ol</option>
              </select>
            </div>
            <button class="btn">Save Preferences</button>
            <div class="logout"><button id="logoutBtn" class="btn">Logout</button></div>
          </div>
        </div>
      </div>
    </section>

    <div class="chatbot-toggle-btn" id="floatingChatBtn"><i class="fas fa-comment"></i></div>

    <footer>
      <div class="footer-content">
        <div class="footer-logo"><i class="fas fa-brain"></i> SmartLearn</div>
        <p>Empowering learners with AI-driven education</p>
        <div class="footer-links">
          <a href="../home.html">Home</a>
          <a href="../courses.html">Courses</a>
          <a href="student.html">Students</a>
          <a href="../chatbot.html">Chatbot</a>
          <a href="../about.html">About</a>
          <a href="../contact.html">Contact</a>
        </div>
        <div class="copyright">&copy; 2025 SmartLearn. All rights reserved.</div>
      </div>
    </footer>

    <script>
      (function(){
        const themeToggle = document.getElementById('themeToggle');
        if (themeToggle) {
          themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const icon = themeToggle.querySelector('i');
            if (icon) {
              if (document.body.classList.contains('dark-mode')) {
                icon.classList.replace('fa-moon','fa-sun');
              } else {
                icon.classList.replace('fa-sun','fa-moon');
              }
            }
          });
        }
        function mountChatbotOverlay(){
          if (document.getElementById('chatbotContainer')) return;
          const wrap = document.createElement('div');
          wrap.className = 'chatbot-container';
          wrap.id = 'chatbotContainer';
          wrap.style.display = 'flex';
          wrap.innerHTML = '<div class="chatbot-header"><h3><i class="fas fa-robot"></i> SmartLearn AI Tutor</h3><button class="close-chat" id="closeChat">&times;</button></div><div class="chat-messages" id="chatMessages"><div class="message bot-message">Hello! I\'m your SmartLearn Assistant. What topic would you like help with?</div></div><div class="chat-input"><input type="text" id="userInput" placeholder="Type your message..." /><button id="sendBtn">Send</button></div>';
          document.body.appendChild(wrap);
          const sendEl = document.getElementById('sendBtn');
          const inputEl = document.getElementById('userInput');
          const closeEl = document.getElementById('closeChat');
          function addMessage(message, isUser){ const box = document.getElementById('chatMessages'); if (!box) return; const div = document.createElement('div'); div.className = 'message ' + (isUser ? 'user-message' : 'bot-message'); div.textContent = message; box.appendChild(div); box.scrollTop = box.scrollHeight; }
          function getBotResponse(msg){ const m = msg.toLowerCase(); const map = { hello:"Hi there!", settings:"You can change preferences here.", default:"Ask about settings or notifications." }; for(const k in map){ if(m.includes(k)) return map[k]; } return map.default; }
          function handleUserMessage(){ const inputEl = document.getElementById('userInput'); if (!inputEl) return; const message = inputEl.value.trim(); if (!message) return; addMessage(message, true); inputEl.value=''; setTimeout(()=>{ addMessage(getBotResponse(message)); }, 500); }
          if (sendEl) sendEl.addEventListener('click', handleUserMessage);
          if (inputEl) inputEl.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleUserMessage(); });
          if (closeEl) closeEl.addEventListener('click', () => { const c = document.getElementById('chatbotContainer'); if (c) c.style.display = 'none'; });
        }
        function toggleChatbot(){ let c = document.getElementById('chatbotContainer'); if(!c){ mountChatbotOverlay(); c = document.getElementById('chatbotContainer'); } if(!c) return; c.style.display = c.style.display==='flex'?'none':'flex'; }
        const sBtn = document.getElementById('chatbotToggle');
        const fBtn = document.getElementById('floatingChatBtn');
        if (sBtn) sBtn.addEventListener('click', toggleChatbot);
        if (fBtn) fBtn.addEventListener('click', toggleChatbot);
      })();
    </script>
    <script>
      const tabBtns = document.querySelectorAll('.tab-btn')
      const tabContents = document.querySelectorAll('.tab-content')
      tabBtns.forEach(btn => btn.addEventListener('click', () => {
        tabBtns.forEach(b => b.classList.remove('active'))
        tabContents.forEach(c => c.classList.remove('active'))
        btn.classList.add('active')
        const target = document.getElementById(btn.dataset.tab)
        if (target) target.classList.add('active')
      }))

      const avatarInput = document.getElementById('avatarInput')
      const avatarPreview = document.getElementById('avatarPreview')
      if (avatarInput) {
        avatarInput.addEventListener('change', () => {
          const file = avatarInput.files[0]
          if (!file) return
          const reader = new FileReader()
          reader.onload = () => {
            avatarPreview.innerHTML = ''
            const img = document.createElement('img')
            img.src = reader.result
            avatarPreview.appendChild(img)
          }
          reader.readAsDataURL(file)
        })
      }

      const prefDark = document.getElementById('prefDark')
      function syncThemeCheckbox() {
        prefDark.checked = document.body.classList.contains('dark-mode')
      }
      syncThemeCheckbox()
      if (prefDark) {
        prefDark.addEventListener('change', () => {
          document.body.classList.toggle('dark-mode', prefDark.checked)
          const icon = document.getElementById('themeToggle')?.querySelector('i')
          if (icon) {
            if (document.body.classList.contains('dark-mode')) {
              icon.classList.replace('fa-moon','fa-sun')
            } else {
              icon.classList.replace('fa-sun','fa-moon')
            }
          }
          localStorage.setItem('prefersDark', prefDark.checked ? '1' : '0')
        })
      }
      const savedPrefDark = localStorage.getItem('prefersDark')
      if (savedPrefDark === '1') {
        document.body.classList.add('dark-mode')
        syncThemeCheckbox()
      }

      const logoutBtn = document.getElementById('logoutBtn')
      if (logoutBtn) {
        logoutBtn.addEventListener('click', () => { window.location.href = '../home.html' })
      }
    </script>
  </body>
</html>
